"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[2653],{36550(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"configuration/tailscale","title":"Tailscale Integration","description":"Perry integrates with Tailscale in two powerful ways:","source":"@site/docs/configuration/tailscale.md","sourceDirName":"configuration","slug":"/configuration/tailscale","permalink":"/perry/docs/configuration/tailscale","draft":false,"unlisted":false,"editUrl":"https://github.com/gricha/perry/tree/main/docs/docs/configuration/tailscale.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"docsSidebar","previous":{"title":"AI Agents","permalink":"/perry/docs/configuration/ai-agents"},"next":{"title":"CLI Reference","permalink":"/perry/docs/cli"}}');var r=s(74848),l=s(28453);const a={sidebar_position:7},t="Tailscale Integration",c={},o=[{value:"Quick Start",id:"quick-start",level:2},{value:"Why Use Tailscale with Perry?",id:"why-use-tailscale-with-perry",level:2},{value:"Without Tailscale",id:"without-tailscale",level:3},{value:"With Tailscale",id:"with-tailscale",level:3},{value:"Part 1: Agent Access (Tailscale Serve)",id:"part-1-agent-access-tailscale-serve",level:2},{value:"Setup",id:"setup",level:3},{value:"1. Install Tailscale",id:"1-install-tailscale",level:4},{value:"2. Enable HTTPS (Recommended)",id:"2-enable-https-recommended",level:4},{value:"3. Set Operator Permissions",id:"3-set-operator-permissions",level:4},{value:"4. Start Perry",id:"4-start-perry",level:4},{value:"Remote Access to Agent",id:"remote-access-to-agent",level:3},{value:"Part 2: Workspace Networking",id:"part-2-workspace-networking",level:2},{value:"Why Workspace Networking?",id:"why-workspace-networking",level:3},{value:"Setup",id:"setup-1",level:3},{value:"1. Generate a Tailscale Auth Key",id:"1-generate-a-tailscale-auth-key",level:4},{value:"2. Configure Perry",id:"2-configure-perry",level:4},{value:"3. Start or Restart Workspaces",id:"3-start-or-restart-workspaces",level:4},{value:"How It Works",id:"how-it-works",level:3},{value:"Accessing Workspaces",id:"accessing-workspaces",level:3},{value:"Viewing Tailscale Status",id:"viewing-tailscale-status",level:3},{value:"Example: Full Workflow",id:"example-full-workflow",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Tailscale Security Model",id:"tailscale-security-model",level:3},{value:"Auth Key Security",id:"auth-key-security",level:3},{value:"Workspace Isolation",id:"workspace-isolation",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Agent: &quot;Tailscale Serve requires operator permissions&quot;",id:"agent-tailscale-serve-requires-operator-permissions",level:3},{value:"Agent: &quot;Tailscale HTTPS not enabled in tailnet&quot;",id:"agent-tailscale-https-not-enabled-in-tailnet",level:3},{value:"Agent: Tailscale Not Detected",id:"agent-tailscale-not-detected",level:3},{value:"Workspace: Not Appearing on Tailnet",id:"workspace-not-appearing-on-tailnet",level:3},{value:"Workspace: Hostname Not Resolving",id:"workspace-hostname-not-resolving",level:3},{value:"Auth Key Expired or Invalid",id:"auth-key-expired-or-invalid",level:3},{value:"Check Agent Info",id:"check-agent-info",level:3},{value:"Behavior Summary",id:"behavior-summary",level:2},{value:"Agent (Tailscale Serve)",id:"agent-tailscale-serve",level:3},{value:"Workspaces",id:"workspaces",level:3},{value:"Advanced: Tailscale ACLs",id:"advanced-tailscale-acls",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"tailscale-integration",children:"Tailscale Integration"})}),"\n",(0,r.jsxs)(n.p,{children:["Perry integrates with ",(0,r.jsx)(n.a,{href:"https://tailscale.com",children:"Tailscale"})," in two powerful ways:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Agent Access"})," - Access your Perry agent remotely from any device on your tailnet"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Workspace Networking"})," - Give each workspace its own hostname on your tailnet for direct access to services"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsx)(n.p,{children:"Already have Tailscale? Here's the 2-minute setup:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# 1. Generate an auth key at https://login.tailscale.com/admin/settings/keys\n#    - Reusable: Yes\n#    - Ephemeral: No\n\n# 2. Open Perry Web UI and configure\nopen http://localhost:7391\n# Go to Settings > Configuration > Networking section, paste your key, click Save\n\n# 3. Start a workspace - it will join your tailnet automatically\nperry start myproject\n\n# 4. Access it from anywhere on your tailnet\ncurl http://myproject:3000\nssh workspace@myproject\n"})}),"\n",(0,r.jsx)(n.p,{children:"That's it! Read on for detailed setup and advanced configuration."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"why-use-tailscale-with-perry",children:"Why Use Tailscale with Perry?"}),"\n",(0,r.jsx)(n.h3,{id:"without-tailscale",children:"Without Tailscale"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Workspaces are only accessible from the host machine"}),"\n",(0,r.jsxs)(n.li,{children:["You need to remember and manage port mappings (e.g., ",(0,r.jsx)(n.code,{children:"localhost:3000"}),", ",(0,r.jsx)(n.code,{children:"localhost:8080"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"No remote access to your development environment"}),"\n",(0,r.jsx)(n.li,{children:"Services can only be accessed via forwarded ports"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"with-tailscale",children:"With Tailscale"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Access your Perry agent from anywhere (laptop, phone, tablet)"}),"\n",(0,r.jsxs)(n.li,{children:["Each workspace gets its own hostname on your tailnet (e.g., ",(0,r.jsx)(n.code,{children:"myproject"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"Direct access to any port on any workspace via MagicDNS"}),"\n",(0,r.jsx)(n.li,{children:"Secure, encrypted connections without exposing ports to the internet"}),"\n",(0,r.jsx)(n.li,{children:"Share development URLs with teammates on your tailnet"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"part-1-agent-access-tailscale-serve",children:"Part 1: Agent Access (Tailscale Serve)"}),"\n",(0,r.jsx)(n.p,{children:"This lets you access the Perry agent (Web UI, API) from any device on your tailnet."}),"\n",(0,r.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,r.jsx)(n.h4,{id:"1-install-tailscale",children:"1. Install Tailscale"}),"\n",(0,r.jsxs)(n.p,{children:["Follow the ",(0,r.jsx)(n.a,{href:"https://tailscale.com/download",children:"Tailscale installation guide"})," for your platform."]}),"\n",(0,r.jsx)(n.h4,{id:"2-enable-https-recommended",children:"2. Enable HTTPS (Recommended)"}),"\n",(0,r.jsxs)(n.p,{children:["Enable HTTPS certificates in your ",(0,r.jsx)(n.a,{href:"https://login.tailscale.com/admin/dns",children:"Tailscale admin console"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"3-set-operator-permissions",children:"3. Set Operator Permissions"}),"\n",(0,r.jsx)(n.p,{children:"Allow Perry to use Tailscale Serve without sudo:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo tailscale set --operator=$USER\n"})}),"\n",(0,r.jsx)(n.p,{children:"This only needs to be done once per machine."}),"\n",(0,r.jsx)(n.h4,{id:"4-start-perry",children:"4. Start Perry"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"perry agent run\n"})}),"\n",(0,r.jsx)(n.p,{children:"If Tailscale is configured, you'll see:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[agent] Tailscale detected: your-machine.tail-scale.ts.net\n[agent] Tailscale Serve enabled\n[agent] Agent running at http://localhost:7391\n[agent] Tailscale HTTPS: https://your-machine.tail-scale.ts.net\n"})}),"\n",(0,r.jsx)(n.h3,{id:"remote-access-to-agent",children:"Remote Access to Agent"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"From another machine on your tailnet:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Configure CLI to use remote agent\nperry config agent your-machine.tail-scale.ts.net\n\n# Use normally\nperry list\nperry start myproject\nperry shell myproject\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"From browser:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"https://your-machine.tail-scale.ts.net"})," (with HTTPS)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"http://your-machine.tail-scale.ts.net:7391"})," (without HTTPS)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"From another device:"})}),"\n",(0,r.jsx)(n.p,{children:"Access the Web UI from any browser on your tailnet."}),"\n",(0,r.jsx)(n.h2,{id:"part-2-workspace-networking",children:"Part 2: Workspace Networking"}),"\n",(0,r.jsx)(n.p,{children:"This is the game-changer. Each workspace can join your tailnet and get its own hostname, making services directly accessible."}),"\n",(0,r.jsx)(n.h3,{id:"why-workspace-networking",children:"Why Workspace Networking?"}),"\n",(0,r.jsxs)(n.p,{children:["Imagine you're working on a web app in a workspace called ",(0,r.jsx)(n.code,{children:"myproject"}),". Instead of:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"http://localhost:3000  # Only works on host machine\n"})}),"\n",(0,r.jsx)(n.p,{children:"You get:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"http://myproject:3000  # Works from any device on your tailnet\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Test a dev server running in a workspace from another device"}),"\n",(0,r.jsxs)(n.li,{children:['Share a preview URL with a teammate: "Check out ',(0,r.jsx)(n.code,{children:"http://myproject:3000"}),'"']}),"\n",(0,r.jsx)(n.li,{children:"Access databases, Redis, or any service running in a workspace"}),"\n",(0,r.jsx)(n.li,{children:"Connect your IDE on one machine to a workspace running on another"}),"\n",(0,r.jsxs)(n.li,{children:["SSH directly into workspaces: ",(0,r.jsx)(n.code,{children:"ssh workspace@myproject"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"setup-1",children:"Setup"}),"\n",(0,r.jsx)(n.h4,{id:"1-generate-a-tailscale-auth-key",children:"1. Generate a Tailscale Auth Key"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Go to ",(0,r.jsx)(n.a,{href:"https://login.tailscale.com/admin/settings/keys",children:"Tailscale Admin Console > Settings > Keys"})]}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Generate auth key"})]}),"\n",(0,r.jsxs)(n.li,{children:["Configure the key:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reusable"}),": Yes (so multiple workspaces can use it)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ephemeral"}),": Yes (recommended) or No - see note below"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tags"}),": Optional, for ACL control"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Expiration"}),": Set based on your security needs"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Copy the key (starts with ",(0,r.jsx)(n.code,{children:"tskey-auth-"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{title:"Ephemeral vs Non-Ephemeral Keys",type:"tip",children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Ephemeral keys (recommended)"}),": Workspaces auto-deregister from your tailnet after being offline for a period. This is ideal because:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Automatic cleanup if a workspace crashes or is force-removed"}),"\n",(0,r.jsx)(n.li,{children:"No orphaned devices cluttering your tailnet"}),"\n",(0,r.jsx)(n.li,{children:"Workspaces re-register automatically on every start"}),"\n"]}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Non-ephemeral keys"}),": Workspaces persist on your tailnet even when stopped. Use this if you want to see offline workspaces in your Tailscale admin console."]}),(0,r.jsx)(n.p,{children:"Perry always attempts to deregister workspaces on delete regardless of key type, but ephemeral keys provide a safety net for edge cases."})]}),"\n",(0,r.jsx)(n.h4,{id:"2-configure-perry",children:"2. Configure Perry"}),"\n",(0,r.jsx)(n.p,{children:"There are several ways to configure your Tailscale auth key:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option A: Web UI Setup Wizard (First-time users)"})}),"\n",(0,r.jsxs)(n.p,{children:["When you first open Perry's Web UI, you'll be guided through a setup wizard that includes a ",(0,r.jsx)(n.strong,{children:"Networking"})," step for Tailscale configuration."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option B: CLI Setup Wizard"})}),"\n",(0,r.jsx)(n.p,{children:"Run the interactive setup wizard:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"perry config init\n"})}),"\n",(0,r.jsx)(n.p,{children:"This walks you through configuring AI agents, GitHub, SSH keys, and Tailscale networking."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option C: Web UI Settings (Recommended)"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Open ",(0,r.jsx)(n.a,{href:"http://localhost:7391",children:"http://localhost:7391"})]}),"\n",(0,r.jsxs)(n.li,{children:["Go to ",(0,r.jsx)(n.strong,{children:"Settings > Configuration"})," in the sidebar"]}),"\n",(0,r.jsxs)(n.li,{children:["Scroll down to the ",(0,r.jsx)(n.strong,{children:"Networking"})," section"]}),"\n",(0,r.jsx)(n.li,{children:"Enable Tailscale and paste your auth key"}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Save"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The Configuration page shows Tailscale alongside other service configurations (AI agents, GitHub)."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option D: Direct config.json edit"})}),"\n",(0,r.jsxs)(n.p,{children:["Edit ",(0,r.jsx)(n.code,{children:"~/.config/perry/config.json"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "tailscale": {\n    "authKey": "tskey-auth-xxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option E: Environment variable"})}),"\n",(0,r.jsx)(n.p,{children:"Set the auth key via environment variable when starting the agent:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'PERRY_TAILSCALE_AUTH_KEY="tskey-auth-..." perry agent run\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"Which method should I use?",type:"tip",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"New to Perry?"})," Use the Web UI Settings page - it's the most user-friendly"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scripting/automation?"})," Use the config.json file or environment variable"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Quick setup?"})," The Web UI at Settings > Tailscale is fastest"]}),"\n"]})}),"\n",(0,r.jsx)(n.h4,{id:"3-start-or-restart-workspaces",children:"3. Start or Restart Workspaces"}),"\n",(0,r.jsx)(n.p,{children:"Workspaces created after configuring Tailscale will automatically join your tailnet."}),"\n",(0,r.jsx)(n.p,{children:"For existing workspaces, restart them:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"perry stop myproject\nperry start myproject\n"})}),"\n",(0,r.jsx)(n.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,r.jsx)(n.p,{children:"When a workspace starts with Tailscale configured:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["The container starts with the ",(0,r.jsx)(n.code,{children:"TS_AUTHKEY"})," environment variable"]}),"\n",(0,r.jsxs)(n.li,{children:["The Tailscale daemon (",(0,r.jsx)(n.code,{children:"tailscaled"}),") starts inside the container"]}),"\n",(0,r.jsxs)(n.li,{children:["The workspace runs ",(0,r.jsx)(n.code,{children:"tailscale up --hostname={prefix}{workspace-name}"})]}),"\n",(0,r.jsxs)(n.li,{children:["The workspace appears on your tailnet (e.g., ",(0,r.jsx)(n.code,{children:"myproject"})," or ",(0,r.jsx)(n.code,{children:"perry-myproject"})," if you set a prefix)"]}),"\n",(0,r.jsx)(n.li,{children:"All ports on the workspace are accessible via this hostname"}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Hostname Prefix",type:"tip",children:(0,r.jsxs)(n.p,{children:["By default, workspaces use their name directly as the hostname (e.g., ",(0,r.jsx)(n.code,{children:"myproject"}),"). You can optionally set a prefix in Settings > Tailscale to distinguish Perry workspaces. If you want a dash separator, include it in the prefix (e.g., ",(0,r.jsx)(n.code,{children:"perry-"})," results in ",(0,r.jsx)(n.code,{children:"perry-myproject"}),")."]})}),"\n",(0,r.jsx)(n.p,{children:"When a workspace is deleted:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Perry runs ",(0,r.jsx)(n.code,{children:"tailscale logout"})," to deregister from your tailnet"]}),"\n",(0,r.jsx)(n.li,{children:"The hostname is removed from your tailnet"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"accessing-workspaces",children:"Accessing Workspaces"}),"\n",(0,r.jsx)(n.p,{children:"Once configured, access any service in any workspace:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Web server on port 3000\ncurl http://myproject:3000\n\n# API on port 8080\ncurl http://backend:8080/api/health\n\n# Database\npsql -h myproject -U postgres\n\n# Redis\nredis-cli -h myproject\n\n# SSH into workspace\nssh workspace@myproject\n"})}),"\n",(0,r.jsx)(n.h3,{id:"viewing-tailscale-status",children:"Viewing Tailscale Status"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Web UI:"})}),"\n",(0,r.jsx)(n.p,{children:"Workspace cards show the Tailscale hostname when connected."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"CLI:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"perry list\n"})}),"\n",(0,r.jsx)(n.p,{children:"Shows Tailscale hostname for each workspace."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Inside workspace:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"tailscale status\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-full-workflow",children:"Example: Full Workflow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# 1. Configure Tailscale (one-time)\n# Go to Settings > Configuration in Web UI and add your auth key in the Networking section\n\n# 2. Create a workspace\nperry start myproject --clone https://github.com/myuser/myapp\n\n# 3. Inside the workspace, start your dev server\nnpm run dev  # Starts on port 3000\n\n# 4. From any device on your tailnet:\n# - Browser: http://myproject:3000\n# - Mobile: Same URL\n# - Another terminal: curl http://myproject:3000\n"})}),"\n",(0,r.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"tailscale-security-model",children:"Tailscale Security Model"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All traffic is encrypted via WireGuard"}),"\n",(0,r.jsx)(n.li,{children:"Only devices on your tailnet can access workspaces"}),"\n",(0,r.jsx)(n.li,{children:"No ports are exposed to the public internet"}),"\n",(0,r.jsx)(n.li,{children:"Tailscale handles authentication and key rotation"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"auth-key-security",children:"Auth Key Security"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Store your auth key securely (Perry stores it in ",(0,r.jsx)(n.code,{children:"~/.config/perry/config.json"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"Use short-lived keys in shared environments"}),"\n",(0,r.jsx)(n.li,{children:"Consider tagged keys with ACLs for team use"}),"\n",(0,r.jsx)(n.li,{children:"Revoke keys in the Tailscale admin console if compromised"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"workspace-isolation",children:"Workspace Isolation"}),"\n",(0,r.jsx)(n.p,{children:"Each workspace is still an isolated Docker container. Tailscale networking adds accessibility, not reduces isolation:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Workspaces can't access each other unless explicitly configured"}),"\n",(0,r.jsx)(n.li,{children:"Host filesystem access is controlled by Perry settings"}),"\n",(0,r.jsx)(n.li,{children:"Network policies can be enforced via Tailscale ACLs"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"agent-tailscale-serve-requires-operator-permissions",children:'Agent: "Tailscale Serve requires operator permissions"'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[agent] Tailscale Serve requires operator permissions\n[agent] To enable: Run: sudo tailscale set --operator=$USER\n[agent] Continuing without HTTPS...\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Fix:"})," Run ",(0,r.jsx)(n.code,{children:"sudo tailscale set --operator=$USER"})," and restart the agent."]}),"\n",(0,r.jsx)(n.h3,{id:"agent-tailscale-https-not-enabled-in-tailnet",children:'Agent: "Tailscale HTTPS not enabled in tailnet"'}),"\n",(0,r.jsxs)(n.p,{children:["Enable HTTPS certificates in your ",(0,r.jsx)(n.a,{href:"https://login.tailscale.com/admin/dns",children:"Tailscale DNS settings"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"agent-tailscale-not-detected",children:"Agent: Tailscale Not Detected"}),"\n",(0,r.jsx)(n.p,{children:"Verify Tailscale is running:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"tailscale status\n"})}),"\n",(0,r.jsx)(n.h3,{id:"workspace-not-appearing-on-tailnet",children:"Workspace: Not Appearing on Tailnet"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Check the auth key is configured in Settings > Configuration > Networking"}),"\n",(0,r.jsxs)(n.li,{children:["Restart the workspace: ",(0,r.jsx)(n.code,{children:"perry stop myproject && perry start myproject"})]}),"\n",(0,r.jsxs)(n.li,{children:["Check container logs: ",(0,r.jsx)(n.code,{children:"docker logs workspace-myproject"})]}),"\n",(0,r.jsxs)(n.li,{children:["Verify tailscaled is running inside: ",(0,r.jsx)(n.code,{children:"docker exec workspace-myproject tailscale status"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"workspace-hostname-not-resolving",children:"Workspace: Hostname Not Resolving"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure MagicDNS is enabled in your ",(0,r.jsx)(n.a,{href:"https://login.tailscale.com/admin/dns",children:"Tailscale admin console"})]}),"\n",(0,r.jsxs)(n.li,{children:["Check the workspace is connected: ",(0,r.jsx)(n.code,{children:"tailscale status"})," (look for your workspace name)"]}),"\n",(0,r.jsxs)(n.li,{children:["Try the full hostname: ",(0,r.jsx)(n.code,{children:"myproject.your-tailnet.ts.net"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"auth-key-expired-or-invalid",children:"Auth Key Expired or Invalid"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Generate a new key in the ",(0,r.jsx)(n.a,{href:"https://login.tailscale.com/admin/settings/keys",children:"Tailscale admin console"})]}),"\n",(0,r.jsx)(n.li,{children:"Update it in Settings > Configuration > Networking"}),"\n",(0,r.jsx)(n.li,{children:"Restart affected workspaces"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"check-agent-info",children:"Check Agent Info"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"perry info\n"})}),"\n",(0,r.jsx)(n.p,{children:"Shows Tailscale status including DNS name and HTTPS URL if available."}),"\n",(0,r.jsx)(n.h2,{id:"behavior-summary",children:"Behavior Summary"}),"\n",(0,r.jsx)(n.h3,{id:"agent-tailscale-serve",children:"Agent (Tailscale Serve)"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Scenario"}),(0,r.jsx)(n.th,{children:"Behavior"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Tailscale not installed"}),(0,r.jsx)(n.td,{children:"Agent runs on localhost only"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Tailscale running, HTTPS enabled, operator set"}),(0,r.jsx)(n.td,{children:"HTTPS via Tailscale Serve"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Tailscale running, HTTPS enabled, no operator"}),(0,r.jsx)(n.td,{children:"Logs instructions, localhost only"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Tailscale running, HTTPS not enabled"}),(0,r.jsx)(n.td,{children:"Agent accessible via Tailscale IP"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"workspaces",children:"Workspaces"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Scenario"}),(0,r.jsx)(n.th,{children:"Behavior"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"No auth key configured"}),(0,r.jsx)(n.td,{children:"Workspaces don't join tailnet"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Auth key configured, workspace starting"}),(0,r.jsxs)(n.td,{children:["Joins/re-joins tailnet as ",(0,r.jsx)(n.code,{children:"{prefix}{name}"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Auth key configured, workspace stopping"}),(0,r.jsx)(n.td,{children:"Depends on key type (ephemeral auto-removes after timeout)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Auth key configured, workspace deleted"}),(0,r.jsxs)(n.td,{children:["Perry runs ",(0,r.jsx)(n.code,{children:"tailscale logout"})," for immediate removal"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"advanced-tailscale-acls",children:"Advanced: Tailscale ACLs"}),"\n",(0,r.jsx)(n.p,{children:"For team environments, use Tailscale ACLs to control access:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "acls": [\n    {\n      "action": "accept",\n      "src": ["group:developers"],\n      "dst": ["tag:perry-workspace:*"]\n    }\n  ],\n  "tagOwners": {\n    "tag:perry-workspace": ["autogroup:admin"]\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Then generate auth keys with the ",(0,r.jsx)(n.code,{children:"tag:perry-workspace"})," tag."]}),"\n",(0,r.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://tailscale.com/kb",children:"Tailscale Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://tailscale.com/kb/1312/serve",children:"Tailscale Serve"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://tailscale.com/kb/1085/auth-keys",children:"Tailscale Auth Keys"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://tailscale.com/kb/1018/acls",children:"Tailscale ACLs"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://tailscale.com/kb/1081/magicdns",children:"MagicDNS"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);